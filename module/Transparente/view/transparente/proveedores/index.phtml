<?php
/**
 * Listar los proveedores
 *
 * @todo poder reordenar el listado
 */

/* @var $this Zend\View\Renderer\PhpRenderer */
?>
<script type="text/javascript">
$(document).ready(function(){
    $('.data-table').DataTable({
        serverSide: true,
        ajax: function(data, callback, settings) {
            // console.log(data);
            // console.log(settings);
            var page = 1 + (data.start / data.length);
            var url = '/api/proveedor?page=' + page + '&size=' + data.length;
            $.getJSON(url, function(api) {
                var elements = [];
                api._embedded.proveedor.forEach(function(element) {
                    var link = '<a href="/transparente/proveedores/detalles/' + element.id + '">' + element.nombre + '</a>';
                    elements.push([link, element.nit]);
                })
                var json = {
                    draw:            data.draw,
                    recordsTotal:    api.total_items,
                    recordsFiltered: api.total_items,
                    data:            elements
                };
                callback(json);
            });
        }
    });
});
</script>

<h1>Proveedores</h1>
<p>
    Listado de todos los proveedores importados del portal de
    <a href="http://guatecompras.gt/proveedores/consultaProveeAdjLst.aspx?lper=2014">Guatecompras</a>.
</p>
<table class="table data-table">
    <thead>
        <tr>
            <th>nombre</th>
            <th class="text-right">nit</th>
        </tr>
    </thead>
</table>